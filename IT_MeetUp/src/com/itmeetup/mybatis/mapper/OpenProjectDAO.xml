<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="com.itmeetup.mybatis.IOpenProjectDAO">
			       
	<!-- 프로젝트 정보 출력 -->
	<select id="openList" resultType="com.itmeetup.mybatis.OpenProjectDTO" >
	
		SELECT "CODE", "CATEGORY", "TITLE", "MOJIBSU", "CONTENT"
        	  ,"VIEW", "START", "END" ,"TEAMNAME", "SIDO"
       		  ,"SIGG", "NICKNAME", "CAREER", "REGDATE" ,"DAY"
		FROM PROJECT_INFO
		
	</select>
	
	<select id="deadlineList" resultType="com.itmeetup.mybatis.OpenProjectDTO" >
	
		SELECT "CODE", "CATEGORY", "TITLE", "MOJIBSU", "CONTENT"
        	  ,"VIEW", "START", "END" ,"TEAMNAME", "SIDO"
       		  ,"SIGG", "NICKNAME", "CAREER", "REGDATE" ,"DAY"
		FROM DEADLINE_INFO
		
		
	</select>
	<update id="viewUpdate">
		UPDATE OPEN_PROJECT
		SET OP_VIEW = OP_VIEW + 1
		WHERE OP_CODE = #{code}
	</update>
	
	<!-- 카테고리 정보 출력 -->
	<select id="cateList" resultType="java.lang.String" >
			SELECT CAT_NAME AS"CATEGORY"
			FROM CATEGORY
	</select>
	
	<!-- 시 도 정보 출력 -->
	<select id="sidoList" resultType="java.lang.String" >
			SELECT SIDO_NAME AS "SIDO"
			FROM SIDO
	</select>
	
	<!-- 군 구 정보 출력 -->
	<select id="siggList" resultType="java.lang.String" >
			SELECT SIGG_NAME AS "SIGG"
			FROM SIGG
	</select>
	
	<!-- 경력 정보 출력 -->
	<select id="carList" resultType="java.lang.String" >
			SELECT CAR_NAME AS "CAREER"
			FROM CAREER
	</select>
	
	<!-- 사용자가 클릭한 프로젝트 정보 출력 -->
	<select id="choiceProList" resultType="com.itmeetup.mybatis.OpenProjectDTO" >
			SELECT "CODE", "CATEGORY", "TITLE", "MOJIBSU", "CONTENT"
       		,"VIEW", "START", "END" ,"TEAMNAME", "SIDO"
       		,"SIGG", "NICKNAME", "MEET","CAREER", "REGDATE" ,"DAY","MEMCODE"
			FROM PROJECT_INFO
			WHERE CODE = #{code}
	</select>
	
	<!-- 프로젝트 해당하는 기술 출력 -->
	<select id="skillList" resultType="java.lang.String" >
			SELECT ASK.SK_NAME AS "SKILL"
			FROM TEAM_SKILL TK
			JOIN ALL_SKILL ASK ON ASK.SK_CODE = TK.TS_SK_CODE
			WHERE TS_OP_CODE = #{code}
	</select>
	
	<!-- 가장 최근 프로젝트 코드 뽑기 -->
	<select id="lastCode" resultType="java.lang.String" >		
		SELECT lastCode
		FROM (
		      SELECT LAST_VALUE(OP_CODE) OVER(ORDER BY OP_DATE DESC) AS lastCode
		      FROM OPEN_PROJECT
		      )A
		WHERE ROWNUM = 1
	</select>
	

	
	
	
</mapper>













